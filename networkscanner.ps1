 $value = foreach ($ip in 35..36){
    Test-NetConnection -Port 22 -InformationLevel "Detailed"192.168.4.$ip 
    }
    $value | where {$_.TcpTestSucceeded -eq "True"} | select ComputerName,Remoteport,TcpTestSucceeded

$value2= 1..30 | foreach {new-object psobject -prop @{Address ="172.21.105.$_";live=
    (Test-Connection "172.21.105.$_" -quiet -count 1) 
    }}
    $value2 | select live,Destination

#get content from text file
$Output= @()
$names = Get-content "D:\tools\scripts\ip.txt"

foreach ($name in $names){
  if (Test-Connection -ComputerName $name -Count 1 -ErrorAction SilentlyContinue){
    Write-Host "$name is up" -ForegroundColor Green
  }
  else{
    Write-Host "$name is down" -ForegroundColor Red
  }
}
$Output
